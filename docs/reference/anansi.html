<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>anansi: Annotation-based Analysis of Specific Interactions. — anansi • anansi</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="anansi: Annotation-based Analysis of Specific Interactions. — anansi"><meta name="description" content="The anansi package package provides tools to prepare and facilitate
integrative association analysis between the features of two data sets that
are known to interact.
1. Input for anansi() with AnansiWeb() and AnansiLinkMap()



randomAnansi, kegg_link(): Generate example input
AnansiWeb-methods, AnansiLinkMap-methods: Handle and manipulate
input





2. Output and cross-compatibility



getAnansi(): Compatibility with mia and
MultiAssayExperiment
getGraph(): Compatibility with igraph
plotAnansi(): Plot output in the style of
miaViz





3. Vignettes



1. Getting started with anansi
2. Adjacency matrices
3. Association testing





Description: The anansi() function


The main workspider function in the anansi package is called
anansi. It manages the individual functionalities of anansi, including
correlation analysis, correlation by group and differential associations.

"><meta property="og:description" content="The anansi package package provides tools to prepare and facilitate
integrative association analysis between the features of two data sets that
are known to interact.
1. Input for anansi() with AnansiWeb() and AnansiLinkMap()



randomAnansi, kegg_link(): Generate example input
AnansiWeb-methods, AnansiLinkMap-methods: Handle and manipulate
input





2. Output and cross-compatibility



getAnansi(): Compatibility with mia and
MultiAssayExperiment
getGraph(): Compatibility with igraph
plotAnansi(): Plot output in the style of
miaViz





3. Vignettes



1. Getting started with anansi
2. Adjacency matrices
3. Association testing





Description: The anansi() function


The main workspider function in the anansi package is called
anansi. It manages the individual functionalities of anansi, including
correlation analysis, correlation by group and differential associations.

"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">anansi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.6.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/anansi.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/adjacency_matrices.html">Adjacency matrices</a></li>
    <li><a class="dropdown-item" href="../articles/differential_associations.html">Association testing</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/thomazbastiaanssen/anansi/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>anansi: Annotation-based Analysis of Specific Interactions.</h1>
      <small class="dont-index">Source: <a href="https://github.com/thomazbastiaanssen/anansi/blob/HEAD/R/anansi-package.R" class="external-link"><code>R/anansi-package.R</code></a>, <a href="https://github.com/thomazbastiaanssen/anansi/blob/HEAD/R/anansi.R" class="external-link"><code>R/anansi.R</code></a></small>
      <div class="d-none name"><code>anansi.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The anansi package package provides tools to prepare and facilitate
integrative association analysis between the features of two data sets that
are known to interact.</p><div class="section">
<h3 id="-input-for-anansi-with-anansiweb-and-anansilinkmap-">1. Input for <code>anansi()</code> with <code><a href="AnansiWeb.html">AnansiWeb()</a></code> and <code><a href="AnansiLinkMap.html">AnansiLinkMap()</a></code><a class="anchor" aria-label="anchor" href="#-input-for-anansi-with-anansiweb-and-anansilinkmap-"></a></h3>


<ul><li><p>randomAnansi, <code><a href="kegg_link.html">kegg_link()</a></code>: Generate example input</p></li>
<li><p><a href="AnansiWeb-methods.html">AnansiWeb-methods</a>, <a href="AnansiLinkMap-methods.html">AnansiLinkMap-methods</a>: Handle and manipulate
input</p></li>
</ul></div>

<div class="section">
<h3 id="-output-and-cross-compatibility">2. Output and cross-compatibility<a class="anchor" aria-label="anchor" href="#-output-and-cross-compatibility"></a></h3>


<ul><li><p><code><a href="getAnansi.html">getAnansi()</a></code>: Compatibility with <a href="%5Bmia::mia%5D">mia</a> and
<a href="%5BMultiAssayExperiment::MultiAssayExperiment%5D">MultiAssayExperiment</a></p></li>
<li><p><code><a href="getGraph.html">getGraph()</a></code>: Compatibility with <a href="%5Bigraph::igraph%5D">igraph</a></p></li>
<li><p><code><a href="plotAnansi.html">plotAnansi()</a></code>: Plot output in the style of
<a href="%5BmiaViz::miaViz%5D">miaViz</a></p></li>
</ul></div>

<div class="section">
<h3 id="-vignettes">3. Vignettes<a class="anchor" aria-label="anchor" href="#-vignettes"></a></h3>


<ul><li><p><a href="https://thomazbastiaanssen.github.io/anansi/articles/anansi.html">1. Getting started with anansi</a></p></li>
<li><p><a href="https://thomazbastiaanssen.github.io/anansi/articles/adjacency_matrices.html">2. Adjacency matrices</a></p></li>
<li><p><a href="https://thomazbastiaanssen.github.io/anansi/articles/association_testing.html">3. Association testing</a></p></li>
</ul></div>

<div class="section">
<h3 id="description-the-anansi-function">Description: The <code>anansi()</code> function<a class="anchor" aria-label="anchor" href="#description-the-anansi-function"></a></h3>


<p>The main workspider function in the anansi package is called
<code>anansi</code>. It manages the individual functionalities of anansi, including
correlation analysis, correlation by group and differential associations.</p>
</div>

    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">anansi</span><span class="op">(</span></span>
<span>  <span class="va">web</span>,</span>
<span>  <span class="va">formula</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  metadata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  adjust.method <span class="op">=</span> <span class="st">"BH"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  return.format <span class="op">=</span> <span class="st">"table"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-web">web<a class="anchor" aria-label="anchor" href="#arg-web"></a></dt>
<dd><p>An <code>AnansiWeb</code> object, containing two tables with 'omics data
and a dictionary that links them. See <code>weaveWebFromTables()</code> for how to
weave a web.</p></dd>


<dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>A formula object. Used to assess differential associations.</p></dd>


<dt id="arg-groups">groups<a class="anchor" aria-label="anchor" href="#arg-groups"></a></dt>
<dd><p>A vector of the column names of categorical values in the
metadata object to control which groups should be assessed for simple
correlations.
If no argument provided, anansi will let you know and still to regular
correlations according to your dictionary.</p></dd>


<dt id="arg-metadata">metadata<a class="anchor" aria-label="anchor" href="#arg-metadata"></a></dt>
<dd><p>A vector or data.frame of categorical or continuous value
necessary for differential correlations. Typically a state or treatment.
If no argument provided, anansi will let you know and still to regular
correlations according to your dictionary.</p></dd>


<dt id="arg-adjust-method">adjust.method<a class="anchor" aria-label="anchor" href="#arg-adjust-method"></a></dt>
<dd><p>Method to adjust p-values for multiple comparisons.
<code>adjust.method = "BH"</code> is the default value. See <code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust()</a></code> in
the base R <code>stats</code> package.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A boolean. Toggles whether to print diagnostic information
while running. Useful for debugging errors on large datasets.</p></dd>


<dt id="arg-return-format">return.format<a class="anchor" aria-label="anchor" href="#arg-return-format"></a></dt>
<dd><p><code>Character scalar</code>. Should be one of <code>"table"</code>
, <code>"list"</code>, or <code>"raw"</code>. Should the output of <code>anansi()</code>
respectively be a wide <code>data.frame</code> of results, a list containing the results
and input, or a list of raw output (used for testing purposes).
convenient use. (Default: <code>"table"</code>)</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments (currently not used).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of lists containing correlation coefficients, p-values and
q-values for all operations.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Useful links:</p><ul><li><p><a href="https://github.com/thomazbastiaanssen/anansi" class="external-link">https://github.com/thomazbastiaanssen/anansi</a></p></li>
<li><p><a href="https://thomazbastiaanssen.github.io/anansi">https://thomazbastiaanssen.github.io/anansi</a></p></li>
<li><p>Report bugs at <a href="https://github.com/thomazbastiaanssen/anansi/issues" class="external-link">https://github.com/thomazbastiaanssen/anansi/issues</a></p></li>
</ul></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p><strong>Maintainer</strong>: Thomaz Bastiaanssen <a href="mailto:thomazbastiaanssen@gmail.com">thomazbastiaanssen@gmail.com</a> (<a href="https://orcid.org/0000-0001-6891-734X" class="external-link">ORCID</a>)</p>
<p>Authors:</p><ul><li><p>Thomas Quinn <a href="mailto:contacttomquinn@gmail.com">contacttomquinn@gmail.com</a> (<a href="https://orcid.org/0000-0003-0286-6329" class="external-link">ORCID</a>)</p></li>
<li><p>Giulio Benedetti <a href="mailto:giulio.benedetti@utu.fi">giulio.benedetti@utu.fi</a> (<a href="https://orcid.org/0000-0002-8732-7692" class="external-link">ORCID</a>)</p></li>
<li><p>Leo Lahti <a href="mailto:leo.lahti@utu.fi">leo.lahti@utu.fi</a> (<a href="https://orcid.org/0000-0001-5537-637X" class="external-link">ORCID</a>)</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load example data:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">FMT_data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Clean and prepare the example data.</span></span></span>
<span class="r-in"><span><span class="co"># In the example dataset, the metabolites are already cleaned.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">KOs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">FMT_KOs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">KOs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">KOs</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">KOs</span> <span class="op">&lt;-</span> <span class="va">KOs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">KOs</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fl">1</span>, <span class="va">sum</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">KOs</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.90</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">KOs</span> <span class="op">&lt;-</span> <span class="va">KOs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">KOs</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ec2ko</span><span class="op">$</span><span class="va">ko</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># CLR-transform.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">KOs.exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="clr_lite.html">clr_c</a></span><span class="op">(</span><span class="va">KOs</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Make sure that columns are features and rows are samples.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">FMT_metab</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">t2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">KOs.exp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run anansi pipeline.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">web</span> <span class="op">&lt;-</span> <span class="fu"><a href="AnansiWeb.html">weaveWeb</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  formula <span class="op">=</span> <span class="va">cpd</span> <span class="op">~</span> <span class="va">ko</span>,</span></span>
<span class="r-in"><span>  tableY <span class="op">=</span> <span class="va">t1</span>,</span></span>
<span class="r-in"><span>  tableX <span class="op">=</span> <span class="va">t2</span>,</span></span>
<span class="r-in"><span>  link <span class="op">=</span> <span class="fu"><a href="kegg_link.html">kegg_link</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">anansi_out</span> <span class="op">&lt;-</span> <span class="fu">anansi</span><span class="op">(</span></span></span>
<span class="r-in"><span>  web <span class="op">=</span> <span class="va">web</span>,</span></span>
<span class="r-in"><span>  formula <span class="op">=</span> <span class="op">~</span><span class="va">Legend</span>,</span></span>
<span class="r-in"><span>  groups <span class="op">=</span> <span class="st">"Legend"</span>,</span></span>
<span class="r-in"><span>  metadata <span class="op">=</span> <span class="va">FMT_metadata</span>,</span></span>
<span class="r-in"><span>  adjust.method <span class="op">=</span> <span class="st">"BH"</span>,</span></span>
<span class="r-in"><span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fitting least-squares for following model:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ~ x + Legend + x:Legend </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running correlations for the following groups:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  Aged yFMT, Aged oFMT, Young yFMT</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use tidyr to wrangle the correlation r-values to a single column</span></span></span>
<span class="r-in"><span><span class="va">anansiLong</span> <span class="op">&lt;-</span> <span class="va">anansi_out</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"All"</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"FMT"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html" class="external-link">separate_wider_delim</a></span><span class="op">(</span><span class="va">name</span>, delim <span class="op">=</span> <span class="st">"_"</span>, names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cor_group"</span>, <span class="st">"param"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">param</span>, values_from <span class="op">=</span> <span class="va">value</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Only consider interactions where the entire model fits well enough.</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">anansiLong</span> <span class="op">&lt;-</span> <span class="va">anansiLong</span><span class="op">[</span><span class="va">anansiLong</span><span class="op">$</span><span class="va">full_p.values</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">anansiLong</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">r.values</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="va">feature_X</span>,</span></span>
<span class="r-in"><span>    fill <span class="op">=</span> <span class="va">cor_group</span>,</span></span>
<span class="r-in"><span>    alpha <span class="op">=</span> <span class="va">disjointed_Legend_p.values</span> <span class="op">&lt;</span> <span class="fl">0.05</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Make a vertical dashed red line at x = 0</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Points show  raw correlation coefficients</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">21</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># facet per compound</span></span></span>
<span class="r-in"><span>  <span class="fu">ggforce</span><span class="fu">::</span><span class="fu"><a href="https://ggforce.data-imaginist.com/reference/facet_row.html" class="external-link">facet_col</a></span><span class="op">(</span><span class="op">~</span><span class="va">feature_Y</span>, space <span class="op">=</span> <span class="st">"free"</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"Young yFMT"</span> <span class="op">=</span> <span class="st">"#2166ac"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Aged oFMT"</span> <span class="op">=</span> <span class="st">"#b2182b"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Aged yFMT"</span> <span class="op">=</span> <span class="st">"#ef8a62"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"All"</span> <span class="op">=</span> <span class="st">"gray"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Using alpha for a discrete variable is not advised.</span>
<span class="r-plt img"><img src="anansi-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using miaViz style function:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="plotAnansi.html">plotAnansi</a></span><span class="op">(</span><span class="va">anansi_out</span>,</span></span>
<span class="r-in"><span>                association.type <span class="op">=</span> <span class="st">"disjointed"</span>,</span></span>
<span class="r-in"><span>                model.var <span class="op">=</span> <span class="st">"Legend"</span>,</span></span>
<span class="r-in"><span>                fill_by <span class="op">=</span> <span class="st">"group"</span>,</span></span>
<span class="r-in"><span>                signif.threshold <span class="op">=</span> <span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>                x_lab <span class="op">=</span> <span class="st">"Pearson's rho"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"Young yFMT"</span> <span class="op">=</span> <span class="st">"#2166ac"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Aged oFMT"</span> <span class="op">=</span> <span class="st">"#b2182b"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Aged yFMT"</span> <span class="op">=</span> <span class="st">"#ef8a62"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"All"</span> <span class="op">=</span> <span class="st">"gray"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">p</span></span></span>
<span class="r-plt img"><img src="anansi-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomaz Bastiaanssen, Thomas Quinn, Giulio Benedetti, Leo Lahti.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

