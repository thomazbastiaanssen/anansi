<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Impute zeroes and perform a centered log-ratio (CLR) transformation — clr_lite • anansi</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Impute zeroes and perform a centered log-ratio (CLR) transformation — clr_lite"><meta name="description" content="Microbiome data is compositional. When compositional data is examined using non-compositional methods, many problems arise.
Performing a centered log-ratio transformation is a reasonable way to address these problems reasonably well.

A major problem with this approach is that microbiome data typically contains lots of zeroes and the logarithm of zero is undefined.
Here, we implemented a few methods discussed by Lubbe et al. 2021 to replace zeroes with non-zero values in such a way that the structure of the data remains reasonably well preserved.

Some of these methods (namely 'logunif' and 'runif') involve imputing small values between 0 and the lowest non-zero value in the dataset.
For these methods, we have implemented a resampling approach in order to stabilize the inter-run variability. See method for more information."><meta property="og:description" content="Microbiome data is compositional. When compositional data is examined using non-compositional methods, many problems arise.
Performing a centered log-ratio transformation is a reasonable way to address these problems reasonably well.

A major problem with this approach is that microbiome data typically contains lots of zeroes and the logarithm of zero is undefined.
Here, we implemented a few methods discussed by Lubbe et al. 2021 to replace zeroes with non-zero values in such a way that the structure of the data remains reasonably well preserved.

Some of these methods (namely 'logunif' and 'runif') involve imputing small values between 0 and the lowest non-zero value in the dataset.
For these methods, we have implemented a resampling approach in order to stabilize the inter-run variability. See method for more information."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">anansi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.6.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/anansi.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/adjacency_matrices.html">Adjacency matrices</a></li>
    <li><a class="dropdown-item" href="../articles/differential_associations.html">Differential association testing with anansi</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/thomazbastiaanssen/anansi/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Impute zeroes and perform a centered log-ratio (CLR) transformation</h1>
      <small class="dont-index">Source: <a href="https://github.com/thomazbastiaanssen/anansi/blob/beta/R/clr_lite.R" class="external-link"><code>R/clr_lite.R</code></a></small>
      <div class="d-none name"><code>clr_lite.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Microbiome data is compositional. When compositional data is examined using non-compositional methods, many problems arise.
Performing a centered log-ratio transformation is a reasonable way to address these problems reasonably well.
<br><br>
A major problem with this approach is that microbiome data typically contains lots of zeroes and the logarithm of zero is undefined.
Here, we implemented a few methods discussed by Lubbe <em>et al.</em> 2021 to replace zeroes with non-zero values in such a way that the structure of the data remains reasonably well preserved.
<br><br>
Some of these methods (namely 'logunif' and 'runif') involve imputing small values between 0 and the lowest non-zero value in the dataset.
For these methods, we have implemented a resampling approach in order to stabilize the inter-run variability. See <code>method</code> for more information.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">clr_lite</span><span class="op">(</span><span class="va">counts</span>, samples_are <span class="op">=</span> <span class="st">"cols"</span>, method <span class="op">=</span> <span class="st">"logunif"</span>, replicates <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">clr_c</span><span class="op">(</span><span class="va">counts</span>, samples_are <span class="op">=</span> <span class="st">"cols"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">clr_unif</span><span class="op">(</span><span class="va">counts</span>, samples_are <span class="op">=</span> <span class="st">"cols"</span>, replicates <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">clr_logunif</span><span class="op">(</span><span class="va">counts</span>, samples_are <span class="op">=</span> <span class="st">"cols"</span>, replicates <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-counts">counts<a class="anchor" aria-label="anchor" href="#arg-counts"></a></dt>
<dd><p>A compositional count table.</p></dd>


<dt id="arg-samples-are">samples_are<a class="anchor" aria-label="anchor" href="#arg-samples-are"></a></dt>
<dd><p>Either "cols" or "rows". Default is "cols". Denotes whether the columns or rows depict individual samples.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>The method for zero imputation. One of <code>"logunif"</code>, <code>"unif"</code> or <code>"const"</code>.
<code>'logunif'</code> samples small numbers from a log-uniform distribution, whereas <code>'unif'</code> samples from a uniform one. On the other hand, <code>"const"</code> simply replaces zeroes with <code>0.65 * [the lowest value]</code>.</p></dd>


<dt id="arg-replicates">replicates<a class="anchor" aria-label="anchor" href="#arg-replicates"></a></dt>
<dd><p>An integer. For the two random sampling methods, if this is larger than 1, every zero will be imputed that many times. The median of the CLR of all those replicates will be returned. If <code>method</code> is set to <code>"const"</code>, replicates will be automatically set to 1 as no random numbers are generated.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A CLR-transformed count table.</p>
    </div>
    <div class="section level2">
    <h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a></h2>


<p><code>clr_c:</code>
 A wrapper for <code>clr_lite(counts, method = "const", replicates = 1)</code>.</p>

<p><code>clr_unif:</code>
 A wrapper for <code>clr_lite(counts, method = "unif")</code>.</p>

<p><code>clr_logunif:</code>
 A wrapper for <code>clr_lite(counts, method = "logunif")</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Sugnet Lubbe, Peter Filzmoser, Matthias Templ (2021)
<em>Comparison of zero replacement strategies for compositional data with large numbers of zeros.</em>
doi:https://doi.org/10.1016/j.chemolab.2021.104248</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomaz Bastiaanssen, Thomas Quinn, Giulio Benedetti, Leo Lahti.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

