---
title: "Differential association testing with anansi"
output:
    BiocStyle::html_document:
        toc: true
        toc_float: true
        toc_depth: 2
        number_sections: true
vignette: >
  %\VignetteIndexEntry{3. Differential association testing}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

<style>
body {
text-align: justify}
</style>

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(anansi)
```

# Overview [-]

### summary 

### link three parts. 

# Getting started though the full model
Overview
full model estimates the effect of x on y.

## formula syntax. 

```{r formula-web-full} 
# setup anansiWeb
Y_MAT <- matrix( rnorm(60*10), nrow = 60, colnames = LETTERS[1:10] )

X_mat  <- matrix( rnorm(60*20), nrow = 60, colnames = letters[1:20] ) 

anansiWeb <- weaveWeb(
y ~ x, 
tableY = Y_MAT, 
tableX = x_mat
link = "none") 
```

### link to adjacency matrix vignette

```{r link-terms} 
terms(anansiWeb) 
```

```{r formula-anansi-full} 
# out <- anansi(anansiWeb, formula = ~ treatment * temperature, metadata = metadata)
```

full is the `x` part of `y ~ x * (a + b + c)`:

drop `x + x:a + x:b + x:c`. 

### compare to `lm()`. 

```{r lm-compare-full} 

```

# Differential association 
Overview:

figures from preprint - already in `R/`. 

```{r fig-diffab, echo=FALSE} 
library ggplot2() 
```

### ref `propr` paper.

## Disjointed association
Overview

### Interpretation:
disjointed is term interaction with `x`, namely, drop `x:a`, `x:b`, `x:c`. 

### compare to `lm()` outcome.

```{r lm-disj} 

```

## Emergent association
    decide on action. 

# Repeated measures with `Error()`

## Random slopes through `Error()`

```{r intro-error} 

# out <- anansi(anansiWeb, formula = ~ treatment * temperature + Error(participant_id), metadata = metadata)

```

### compare to `aov( Error() )`.

```{r aov-error} 

```

### corresponding `lm()`

``{r lm-error} 

```

# Session info

```{r}
sessionInfo()
```
