% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/AllGenerics.R, R/plotAnansi-methods.R
\name{plotAnansi}
\alias{plotAnansi}
\alias{plotAnansi,data.frame-method}
\title{miaViz style plotting wrapper for anansi output}
\usage{
plotAnansi(x, ...)

plotAnansi(x, ...)

\S4method{plotAnansi}{data.frame}(
  x,
  association.type = NULL,
  model.var = NULL,
  signif.threshold = NULL,
  colour_by = NULL,
  color_by = colour_by,
  fill_by = NULL,
  size_by = NULL,
  shape_by = NULL,
  y_position = "right",
  x_lab = "cor",
  y_lab = ""
)
}
\arguments{
\item{x}{a \code{data.frame} object output of \code{\link{getAnansi}} in
the table format.}

\item{...}{additional arguments}

\item{association.type}{\code{Character scalar}. Specifies the type of
association to show in the plot. One of \code{"disjointed"},
  \code{"emergent"} and \code{"full"}. (Default: \code{NULL})}

\item{model.var}{\code{Character scalar}. Specifies the name of a variable
in the anansi model. It is relevant only when \code{association.type} is
  \code{"disjointed"} or \code{"emergent"}. (Default: \code{NULL})}

\item{signif.threshold}{\code{Numeric scalar}. Specifies the threshold to
mark the significance of \code{association.type}. (Default: \code{NULL})}

\item{colour_by}{\code{Character scalar}. Specifies one of the \code{groups}
terms used in the original \code{anansi} call, \code{x} by which points
should be coloured. (Default: \code{NULL})}

\item{color_by}{\code{Character scalar}. Alias to \code{colour_by}.}

\item{fill_by}{\code{Character scalar}. Specifies one of the \code{groups}
terms used in the original \code{anansi} call, \code{x} by which points
should be filled (Default: \code{NULL})}

\item{size_by}{\code{Character scalar}. Specifies one of the \code{groups}
terms used in the original \code{anansi} call, \code{x} by which points
should be sized. (Default: \code{NULL})}

\item{shape_by}{\code{Character scalar}. Specifies one of the \code{groups}
terms used in the original \code{anansi} call, \code{x} by which points
should be shaped. (Default: \code{NULL})}

\item{y_position}{\code{Character scalar}. Specifies the position of the y
labels. It should be either \code{"left"} or \code{"right"}.
(Default: \code{"right"})}

\item{x_lab}{\code{Character scalar}. Specifies the label of the x axis.
(Default: \code{"cor"})}

\item{y_lab}{\code{Character scalar}. Specifies the label of the y axis.
(Default: \code{""})}
}
\value{
A ggplot2 object.
}
\description{
\code{plotAnansi} generates a standard dissociation plot from the output of
\code{\link{getAnansi}} in the table format. It provides a convenient way to
visually assess relevant results from the anansi analysis.
}
\details{
\code{plotAnansi} provides a standardised method to visualise the results
of anansi by means of a differential association plot. The input for this
function should be generated from \code{\link{getAnansi}} or
\code{\link{anansi}}, with \code{return.format = "table"}
}
\examples{
# Import libraries
library(mia)
library(TreeSummarizedExperiment)
library(MultiAssayExperiment)

# Load data
data("FMT_data", package = "anansi")

# Convert to (Tree)SummarizedExperiment objects
metab_se <- SummarizedExperiment(assays = SimpleList(conc = as.matrix(FMT_metab)))
KO_tse <- TreeSummarizedExperiment(assays = SimpleList(counts = as.matrix(FMT_KOs)))

# Select functions that are represented in the dictionary
keep <- row.names(KO_tse) \%in\% sort(unique(ec2ko$ko))
KO_tse <- KO_tse[keep, ]

# Remove features with less than 10\% prevalence
KO_tse <- subsetByPrevalent(KO_tse,
  assay.type = "counts",
  prevalence = 0.1
)

# Perform a centered log-ratio transformation on the functional counts assay
KO_tse <- transformAssay(KO_tse,
  assay.type = "counts",
  method = "clr",
  pseudocount = TRUE
)

# Prepare colData
coldata <- FMT_metadata
rownames(coldata) <- coldata$Sample_ID
coldata <- coldata[match(colnames(KO_tse), rownames(coldata)), ]

# Combine experiments into MultiAssayExperiment object
mae <- MultiAssayExperiment(
  experiments = ExperimentList(cpd = metab_se, ko = KO_tse),
  colData = coldata
)

# Perform anansi analysis
out <- getAnansi(mae,
  experimentY = "cpd", experimentX = "ko",
  assay.typeY = "conc", assay.typeX = "clr",
  formula = ~Legend)

# Select significant interactions
out <- out[out$full_p.values < 0.05, ]

# Visualise disjointed associations filled by group
plotAnansi(out,
           association.type = "disjointed",
           model.var = "Legend",
           signif.threshold = 0.05,
           fill_by = "group")

# Visualise full associations filled by Legend
plotAnansi(out,
           association.type = "full",
           signif.threshold = 0.05,
           fill_by = "Legend")

}
\seealso{
\code{\link{getAnansi}}
\code{\link{anansi}}
}
