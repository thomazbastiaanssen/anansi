% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/AllGenerics.R, R/getAnansi-methods.R
\name{getAnansi}
\alias{getAnansi}
\alias{getAnansi,MultiAssayExperiment-method}
\title{anansi wrapper for the MultiAssayExperiment class}
\usage{
getAnansi(x, ...)

\S4method{getAnansi}{MultiAssayExperiment}(
  x,
  experimentY = 1,
  experimentX = 2,
  assay.typeY = "counts",
  assay.typeX = "counts",
  ...
)
}
\arguments{
\item{x}{a \code{\link[MultiAssayExperiment:MultiAssayExperiment]{MultiAssayExperiment}}.}

\item{...}{additional parameters that can be passed to
\code{\link{web}} or \code{\link{anansi}}.}

\item{experimentY, experimentX}{\code{Character scalar} or \code{numeric scalar}. Selects experiment 
corresponding to \code{tableY} and \code{tableX} from \code{experiments(x)} 
of \code{MultiAssayExperiment} object by name or index, name is recommended. 
(Default slots: \code{Y = 1}, \code{X = 2}).}

\item{assay.typeY, assay.typeX}{\code{Character scalar}. Specifies the name of the assay in experiments Y and
X to be used. (Default: \code{"counts"})}
}
\value{
If \code{return.format} is \code{"table"} (default), a wide format data.frame
intended to be compatible with `ggplot2`, or specialized plotting functions
(See \code{\link{plotAnansi}}). If \code{return.format} is
\code{"list"}, a list with aforementioned table, as well as input and
additional information. If \code{return.format} is \code{"raw"}, a list of
raw output (used for testing purposes).
}
\description{
\code{getAnansi} provides a wrapper to execute the anansi pipeline on a
\code{\link[MultiAssayExperiment:MultiAssayExperiment]{MultiAssayExperiment}}
object. It applies the functions \code{\link{weaveWeb}} and
\code{\link{anansi}} in the given order.
}
\details{
This wrapper of \code{\link{anansi}} allows to perform a complete anansi
analysis directly on objects of class
\code{\link[MultiAssayExperiment:MultiAssayExperiment]{MultiAssayExperiment}}
. First, the assays specified by \code{assay.typeY} and \code{assay.typeX}
are passed to \code{\link{web}} to build an anansiWeb object.
Next, this object is fed to the main \code{\link{anansi}} function to compute
interactions between the two assays.
}
\examples{

# Import libraries
library(mia)
library(TreeSummarizedExperiment)
library(MultiAssayExperiment)

# Load data
data("FMT_data", package = "anansi")

# Convert to (Tree)SummarizedExperiment objects
metab_se <- SummarizedExperiment(assays = SimpleList(conc = as.matrix(FMT_metab)))
KO_tse <- TreeSummarizedExperiment(assays = SimpleList(counts = as.matrix(FMT_KOs)))

# Select functions that are represented in the dictionary
keep <- row.names(KO_tse) \%in\% sort(unique(unlist(anansi_dic)))
KO_tse <- KO_tse[keep, ]

# Remove features with less than 10\% prevalence
KO_tse <- subsetByPrevalent(KO_tse,
  assay.type = "counts",
  prevalence = 0.1
)

# Perform a centered log-ratio transformation on the functional counts assay
KO_tse <- transformAssay(KO_tse,
  assay.type = "counts",
  method = "clr",
  pseudocount = TRUE
)

# Prepare colData
coldata <- FMT_metadata
rownames(coldata) <- coldata$Sample_ID
coldata <- coldata[match(colnames(KO_tse), rownames(coldata)), ]

# Combine experiments into MultiAssayExperiment object
mae <- MultiAssayExperiment(
  experiments = ExperimentList(cpd = metab_se, ko = KO_tse),
  colData = coldata
)

# Perform anansi analysis
out <- getAnansi(mae,
  experimentY = "cpd", experimentX = "ko",
  assay.typeY = "conc", assay.typeX = "clr",
  formula = ~Legend
)

# Select significant interactions
out <- out[out$full_p.values < 0.05, ]

# View subset of results
head(out, 5)

}
\seealso{
\code{\link{web}}
\code{\link{anansi}}
}
