% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/getAnansi.R
\name{getAnansi}
\alias{getAnansi}
\alias{getAnansi,MultiAssayExperiment-method}
\title{anansi wrapper for the MultiAssayExperiment class}
\usage{
getAnansi(x, ...)

\S4method{getAnansi}{MultiAssayExperiment}(
  x,
  experiment1 = 1,
  experiment2 = 2,
  assay.type1 = "counts",
  assay.type2 = "counts",
  return.long = TRUE,
  ...
)
}
\arguments{
\item{x}{a
\code{\link[MultiAssayExperiment:MultiAssayExperiment]{MultiAssayExperiment}}.}

\item{...}{additional parameters that can be passed to
\code{\link{weaveWebFromTables}}, \code{\link{anansi}} or
\code{\link{spinToLong}}.}

\item{experiment1}{\code{Character scalar} or \code{numeric scalar}.
Selects the experiment 1 from \code{experiments(x)} of
\code{MultiassayExperiment} object. (Default: \code{1})}

\item{experiment2}{\code{Character scalar} or \code{numeric scalar}.
Selects the experiment 2 from\code{experiments(x)} of
\code{MultiAssayExperiment} object. (Default: \code{2})}

\item{assay.type1}{\code{Character scalar}. Specifies the name of the assay
in experiment 1 to be used. (Default: \code{"counts"})}

\item{assay.type2}{\code{Character scalar}. Specifies the name of the
assay in experiment 2 to be used. (Default: \code{"counts"})}

\item{return.long}{\code{Logical scalar}. Should the output of
\code{\link{anansi}} be passed to \code{\link{spinToLong}} for convenient
use. (Default: \code{TRUE})}
}
\value{
If \code{return.long} is TRUE (default), a long format data.frame intended to
be compatible with ggplot2. If \code{return.long} is FALSE, a list of lists
containing correlation coefficients, p-values and q-values for all operations.
}
\description{
\code{getAnansi} provides a wrapper to execute the anansi pipeline on a
\code{\link[MultiAssayExperiment:MultiAssayExperiment]{MultiAssayExperiment}}
object. It applies the functions \code{\link{weaveWebFromTables}},
\code{\link{anansi}} and optionally \code{\link{spinToLong}} in the given
order.
}
\details{
This wrapper of \code{\link{anansi}} allows to perform a complete anansi
analysis directly on objects of class
\code{\link[MultiAssayExperiment:MultiAssayExperiment]{MultiAssayExperiment}}.
First, the assays specified by \code{assay.type1} and \code{assay.type2}
are passed to \code{\link{weaveWebFromTables}} to produce an anansiWeb object.
Next, this object is fed to the main \code{\link{anansi}} function to compute
interactions between the two assays. Finally, the output can be simplified
with \code{\link{spinToLong}} for easy manipulation and visualisation.
}
\examples{

# Import libraries
library(mia)
library(TreeSummarizedExperiment)
library(MultiAssayExperiment)

# Load data
data("FMT_metab", package = "anansi")
data("FMT_KOs", package = "anansi")
data("anansi_dict", package = "anansi")

# Convert to (Tree)SummarizedExperiment objects
metab_se <- SummarizedExperiment(assays = SimpleList(conc = as.matrix(FMT_metab)))
KO_tse <- TreeSummarizedExperiment(assays = SimpleList(counts = as.matrix(FMT_KOs)))

# Select functions that are represented in the dictionary
keep <- row.names(KO_tse) \%in\% sort(unique(unlist(anansi_dic)))
KO_tse <- KO_tse[keep, ]

# Remove features with less than 10\% prevalence
KO_tse <- subsetByPrevalent(KO_tse,
                            assay.type = "counts",
                            prevalence = 0.1)

# Perform a centered log-ratio transformation on the functional counts assay
KO_tse <- transformAssay(KO_tse,
                         assay.type = "counts",
                         method = "clr",
                         pseudocount = TRUE)
                         
# Prepare colData
coldata <- FMT_metadata
rownames(coldata) <- coldata$Sample_ID
coldata <- coldata[match(colnames(KO_tse), rownames(coldata)), ]

# Combine experiments into MultiAssayExperiment object
mae <- MultiAssayExperiment(
    experiments = ExperimentList(metabolites = metab_se, functions = KO_tse),
    colData = coldata
)

# Perform anansi analysis
out <- getAnansi(mae,
                 experiment1 = "metabolites", experiment2 = "functions",
                 assay.type1 = "conc", assay.type2 = "clr",
                 formula = ~ Legend)

# Select significant interactions
out <- out[out$model_full_q.values < 0.1, ]

# View subset of results
head(out, 5)

}
\seealso{
\code{\link{weaveWebFromTables}}
\code{\link{anansi}}
\code{\link{spinToLong}}
}
