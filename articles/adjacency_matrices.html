<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Adjacency matrices • anansi</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Adjacency matrices">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">anansi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.6.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/anansi.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/adjacency_matrices.html">Adjacency matrices</a></li>
    <li><a class="dropdown-item" href="../articles/differential_associations.html">Association testing</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/thomazbastiaanssen/anansi/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Adjacency matrices</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/thomazbastiaanssen/anansi/blob/devel/vignettes/adjacency_matrices.Rmd" class="external-link"><code>vignettes/adjacency_matrices.Rmd</code></a></small>
      <div class="d-none name"><code>adjacency_matrices.Rmd</code></div>
    </div>

    
    
<style>
body {
text-align: justify}
</style>
<div class="section level2">
<h2 class="unnumbered" id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>A common challenge in integrative analysis of high-dimensional data
sets is subsequent biological interpretation. Anansi addresses this
challenge by only considering pairwise associations that are known to
occur <em>a priori</em>. In order to achieve this, we need to provide
this relational information to anansi in the form of a (bi)adjacency
matrix.</p>
<p>This vignette is divided by two sections:</p>
<ul>
<li>
<a href="#sec-mat-1">Section 1</a> introduces (bi)adjacency matrices
in the context of the anansi framework.<br>
</li>
<li>
<a href="#sec-mat-2">Section 2</a> introduces the
<code>AnansiWeb</code> object and demonstrates how to work with it</li>
</ul>
</div>
<div class="section level2">
<h2 id="sec-mat-1">Understanding adjacency matrices<a class="anchor" aria-label="anchor" href="#sec-mat-1"></a>
</h2>
<div class="section level3">
<h3 id="example-from-biology-the-krebs-cycle">Example from Biology: The Krebs cycle<a class="anchor" aria-label="anchor" href="#example-from-biology-the-krebs-cycle"></a>
</h3>
<p>Recall that the <a href="https://en.wikipedia.org/wiki/Citric_acid_cycle" class="external-link">citric acid
cycle, or Krebs cycle</a>, is a central piece of metabolic machinery. In
short, it enables oxidative phosphorylation. See figure
@ref(fig:plot-krebs) below for a simplified representation. In the
figure, there are 8 unique enzymatic reactions and 9 unique
metabolites.</p>
<div class="figure">
<img src="adjacency_matrices_files/figure-html/plot-krebs-1.png" alt="Two simplified representations of the Krebs cycle. Orange marks 
metabolites and blue marks enzymes." width="700"><p class="caption">
Two simplified representations of the Krebs cycle. Orange marks
metabolites and blue marks enzymes.
</p>
</div>
</div>
<div class="section level3">
<h3 id="adjacency-matrices-allow-us-to-be-specific-in-our-questions">Adjacency matrices allow us to be specific in our questions<a class="anchor" aria-label="anchor" href="#adjacency-matrices-allow-us-to-be-specific-in-our-questions"></a>
</h3>
<p>Let’s imagine we had (high-dimensional proxy) measurements available
for both types. For instance, we could have transcription data for the
enzymes and metabolomics data for the metabolites. We could represent
our two data sets like two sets of features.</p>
<div class="section level4">
<h4 id="all-vs-all-testing">All vs-all testing<a class="anchor" aria-label="anchor" href="#all-vs-all-testing"></a>
</h4>
<p>If we were to perform an all-vs-all integrative analysis between our
two data sets, comprehensively testing every metabolite-enzyme pair,
we’d test <span class="math inline">\(8\times9=72\)</span> hypotheses.
Figure @ref(fig:all-v-all) A.</p>
<div class="figure">
<img src="adjacency_matrices_files/figure-html/all-v-all-1.png" alt="Graph representation of possible association sctructures in the 
Krebs cycle. **A)** All-vs-all, with a full graph. **B)** Constrained, only 
linking metabolites an enzymes that are known to directly interact." width="100%" height="60%"><p class="caption">
Graph representation of possible association sctructures in the Krebs
cycle. <strong>A)</strong> All-vs-all, with a full graph.
<strong>B)</strong> Constrained, only linking metabolites an enzymes
that are known to directly interact.
</p>
</div>
</div>
<div class="section level4">
<h4 id="knowledge-informed-analyis-of-specific-interactions">Knowledge-informed analyis of specific interactions<a class="anchor" aria-label="anchor" href="#knowledge-informed-analyis-of-specific-interactions"></a>
</h4>
<p>Often however, only a subset of these comparisons is scientifically
relevant to investigate. In this case for instance, only 17 associations
between enzyme-metabolite pairs are likely to make sense. Figure
@ref(fig:all-v-all) A. Non-selectively testing all 72 associations
actively harms statistical power, as 55 of these tests likely cannot be
interpreted, but their p-values will still be tallied for the purpose of
FDR and FWER. Moreover, they tend to obscure any biologically
interpretable findings.</p>
<p>In order to ‘know’ which features-pairs in your data set should be
considered, anansi requires a <em>biadjacency matrix</em>. The
biadjacency matrix corresponding to to the sparse graph in figure
@ref(fig:all-v-all) B can be seen in figure @ref(fig:krebs-biadj).</p>
<div class="figure">
<img src="adjacency_matrices_files/figure-html/krebs-biadj-1.png" alt="Matrix representation of the constrained analysis of the Krebs cycle, 
with cells marked with 'X' signifying tested feature-pairs." width="700"><p class="caption">
Matrix representation of the constrained analysis of the Krebs cycle,
with cells marked with ‘X’ signifying tested feature-pairs.
</p>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="sec-mat-2">General use in anansi<a class="anchor" aria-label="anchor" href="#sec-mat-2"></a>
</h2>
<p>In anansi, we work with biadjacency matrices in the
<code>AnansiWeb</code> S4 class, which consists of a biadjacency matrix,
in this case we call it a <code>dictionary</code>, as well as two tables
of observations that should be analysed jointly.</p>
<p>The anansi package offers some functions that should be sufficient
for basic analysis. To enable more advanced users to pursue non-standard
applications, our methodology is compatible with several popular
interfaces.</p>
<div class="section level3">
<h3 id="make-a-biadjacency-matrix-with-weaveweb">Make a biadjacency matrix with <code>weaveWeb()</code><a class="anchor" aria-label="anchor" href="#make-a-biadjacency-matrix-with-weaveweb"></a>
</h3>
<p>The recommended default interface to generate an
<code>AnansiWeb</code> object is <code><a href="../reference/AnansiWeb.html">weaveWeb()</a></code>. Besides a
traditional interface, it also accepts R <code>formula</code> syntax.
Once we have an <code>AnansiWeb</code> object, we can use the $ operator
to access the biadjacency matrix in the ‘dictionary’ slot.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Two interfaces</span></span>
<span><span class="va">form.web</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AnansiWeb.html">weaveWeb</a></span><span class="op">(</span><span class="va">ec</span> <span class="op">~</span> <span class="va">ko</span>, link <span class="op">=</span> <span class="fu"><a href="../reference/kegg_link.html">kegg_link</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">trad.web</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AnansiWeb.html">weaveWeb</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"ec"</span>, x <span class="op">=</span> <span class="st">"ko"</span>, link <span class="op">=</span> <span class="fu"><a href="../reference/kegg_link.html">kegg_link</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Same output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">form.web</span>, <span class="va">trad.web</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the biadjacency matrix using the $ operator</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span> <span class="va">form.web</span><span class="op">$</span><span class="va">dictionary</span>,  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 10 x 10 sparse Matrix of class "dgCMatrix"</span></span></code></pre>
<pre><code><span><span class="co">##   [[ suppressing 10 column names 'K00001', 'K00002', 'K00003' ... ]]</span></span></code></pre>
<pre><code><span><span class="co">##            ko</span></span>
<span><span class="co">## ec                             </span></span>
<span><span class="co">##   1.1.1.1   1 . . . . . . . . .</span></span>
<span><span class="co">##   1.1.1.10  . . . . . . . . . .</span></span>
<span><span class="co">##   1.1.1.100 . . . . . . . . . .</span></span>
<span><span class="co">##   1.1.1.101 . . . . . . . . . .</span></span>
<span><span class="co">##   1.1.1.102 . . . . . . . . . .</span></span>
<span><span class="co">##   1.1.1.103 . . . . . . . . . .</span></span>
<span><span class="co">##   1.1.1.104 . . . . . . . . . .</span></span>
<span><span class="co">##   1.1.1.105 . . . . . . . . . .</span></span>
<span><span class="co">##   1.1.1.107 . . . . . . . . . .</span></span>
<span><span class="co">##   1.1.1.108 . . . . . . . . . .</span></span></code></pre>
<p>Note that the majority of this matrix consists of dots, it’s a sparse
matrix, which is a format that can considerably speed up calculations
involving huge, mostly empty matrices. For further reading, see the <a href="https://matrix.r-forge.r-project.org/" class="external-link">Matrix package
website</a>.</p>
<div class="section level4">
<h4 id="weaveweb-input-link">
<code>weaveWeb()</code> input: <code>link</code><a class="anchor" aria-label="anchor" href="#weaveweb-input-link"></a>
</h4>
<p><code><a href="../reference/AnansiWeb.html">weaveWeb()</a></code> takes additional arguments, let’s focus on
<code>link</code>, which will take the information necessary to link
features between input data sets. The anansi package includes such data
for the <a href="https://www.genome.jp/kegg/" class="external-link">KEGG database</a>, let’s
take a look at some of it:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ec2ko</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          ec     ko</span></span>
<span><span class="co">## 1   1.1.1.1 K00001</span></span>
<span><span class="co">## 2   1.1.1.2 K00002</span></span>
<span><span class="co">## 3   1.1.1.3 K00003</span></span>
<span><span class="co">## 4   1.1.1.4 K00004</span></span>
<span><span class="co">## 5 1.1.1.303 K00004</span></span>
<span><span class="co">## 6   1.1.1.6 K00005</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="structure-of-link-input">Structure of <code>link</code> input<a class="anchor" aria-label="anchor" href="#structure-of-link-input"></a>
</h4>
<p>The format of the <code>data.frame</code> is important: It should
have two named columns. Each column contains feature IDs of one type (in
this case, <code>ec</code> and <code>ko</code>, which is how the KEGG
database refers to <a href="https://enzyme.expasy.org/" class="external-link">Enzyme
Commission numbers</a> and <a href="https://www.genome.jp/kegg/ko.html" class="external-link">kegg orthologes</a>,
respectively. If two feature IDs are on the same row of the
<code>data.frame</code>, it means those features are paired (hence
adjacency).</p>
</div>
<div class="section level4">
<h4 id="linking-between-feature-names">linking between feature names<a class="anchor" aria-label="anchor" href="#linking-between-feature-names"></a>
</h4>
<p>The column names correspond to the types of feature IDs that should
be linked. These names are used throughout the <code>AnansiWeb</code>
workflow. They can be directly called from an <code>AnansiWeb</code>
object:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Note that the formula controls the order </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span> <span class="fu"><a href="../reference/AnansiWeb.html">weaveWeb</a></span><span class="op">(</span><span class="va">ko</span><span class="op">~</span><span class="va">ec</span>, link <span class="op">=</span> <span class="fu"><a href="../reference/kegg_link.html">kegg_link</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">dictionary</span> <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "ko" "ec"</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># names() is short for the above</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="../reference/AnansiWeb.html">weaveWeb</a></span><span class="op">(</span><span class="va">ec</span><span class="op">~</span><span class="va">ko</span>, link <span class="op">=</span> <span class="fu"><a href="../reference/kegg_link.html">kegg_link</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "ec" "ko"</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="the-pre-packaged-kegg-linking-map">The pre-packaged kegg linking map<a class="anchor" aria-label="anchor" href="#the-pre-packaged-kegg-linking-map"></a>
</h3>
<p>We need to provide <code><a href="../reference/AnansiWeb.html">weaveWeb()</a></code> with a map of which
features are linked. We can use the pre-packaged kegg link map, which
consists of two similarly structured <code>data.frame</code>s in a list,
one of which we just inspected. We can call it directly using
<code><a href="../reference/kegg_link.html">kegg_link()</a></code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Only print the first few entries</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span> <span class="fu"><a href="../reference/kegg_link.html">kegg_link</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">head</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $ec2ko</span></span>
<span><span class="co">##          ec     ko</span></span>
<span><span class="co">## 1   1.1.1.1 K00001</span></span>
<span><span class="co">## 2   1.1.1.2 K00002</span></span>
<span><span class="co">## 3   1.1.1.3 K00003</span></span>
<span><span class="co">## 4   1.1.1.4 K00004</span></span>
<span><span class="co">## 5 1.1.1.303 K00004</span></span>
<span><span class="co">## 6   1.1.1.6 K00005</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $ec2cpd</span></span>
<span><span class="co">##          ec    cpd</span></span>
<span><span class="co">## 1   1.1.1.1 C00001</span></span>
<span><span class="co">## 2 1.1.1.115 C00001</span></span>
<span><span class="co">## 3 1.1.1.132 C00001</span></span>
<span><span class="co">## 4 1.1.1.136 C00001</span></span>
<span><span class="co">## 5 1.1.1.170 C00001</span></span>
<span><span class="co">## 6 1.1.1.186 C00001</span></span></code></pre>
<div class="section level4">
<h4 id="linking-across-two-data-frame">linking across two <code>data.frame</code><a class="anchor" aria-label="anchor" href="#linking-across-two-data-frame"></a>
</h4>
<p>Note the column names in the two <code>data.frames</code>:
<code>ec</code>, <code>cpd</code> and <code>ko</code>. Two of these
correspond to the formula we used just used:
<code>weaveWeb(ec ~ ko)</code>. We didn’t use the term <code>cpd</code>.
Further, <code>ec</code> is present in both
<code>data.frame</code>s.</p>
<p>We can use <code><a href="../reference/AnansiWeb.html">weaveWeb()</a></code> to make a biadjacency matrix
between any combination of one or two similarly structured
<code>data.frame</code>s, presented as a list. For the pre- packaged
data set, this means we can link between any two of <code>ec</code>,
<code>cpd</code> and <code>ko</code>, in either order.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Formula notation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span> <span class="fu"><a href="../reference/AnansiWeb.html">weaveWeb</a></span><span class="op">(</span><span class="va">cpd</span> <span class="op">~</span> <span class="va">ko</span>, link <span class="op">=</span> <span class="fu"><a href="../reference/kegg_link.html">kegg_link</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">dictionary</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 10 x 10 sparse Matrix of class "ngCMatrix"</span></span></code></pre>
<pre><code><span><span class="co">##   [[ suppressing 10 column names 'K00001', 'K00002', 'K00003' ... ]]</span></span></code></pre>
<pre><code><span><span class="co">##         ko</span></span>
<span><span class="co">## cpd                         </span></span>
<span><span class="co">##   C00001 | . . . . . . . . .</span></span>
<span><span class="co">##   C00002 . . . . . . . . . .</span></span>
<span><span class="co">##   C00003 | . | | | | | | | |</span></span>
<span><span class="co">##   C00004 | . | | | | | | | |</span></span>
<span><span class="co">##   C00005 | | | . . . . . . .</span></span>
<span><span class="co">##   C00006 | | | . . . . . . .</span></span>
<span><span class="co">##   C00007 . . . . . . . . . .</span></span>
<span><span class="co">##   C00008 . . . . . . . . . .</span></span>
<span><span class="co">##   C00009 . . . . . . . . . .</span></span>
<span><span class="co">##   C00010 . . . . . . . . . .</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Character notation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span> <span class="fu"><a href="../reference/AnansiWeb.html">weaveWeb</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"ko"</span>, x <span class="op">=</span> <span class="st">"cpd"</span>, link <span class="op">=</span> <span class="fu"><a href="../reference/kegg_link.html">kegg_link</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">dictionary</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 10 x 10 sparse Matrix of class "ngCMatrix"</span></span></code></pre>
<pre><code><span><span class="co">##   [[ suppressing 10 column names 'C00001', 'C00002', 'C00003' ... ]]</span></span></code></pre>
<pre><code><span><span class="co">##         cpd</span></span>
<span><span class="co">## ko                          </span></span>
<span><span class="co">##   K00001 | . | | | | . . . .</span></span>
<span><span class="co">##   K00002 . . . . | | . . . .</span></span>
<span><span class="co">##   K00003 . . | | | | . . . .</span></span>
<span><span class="co">##   K00004 . . | | . . . . . .</span></span>
<span><span class="co">##   K00005 . . | | . . . . . .</span></span>
<span><span class="co">##   K00006 . . | | . . . . . .</span></span>
<span><span class="co">##   K00007 . . | | . . . . . .</span></span>
<span><span class="co">##   K00008 . . | | . . . . . .</span></span>
<span><span class="co">##   K00009 . . | | . . . . . .</span></span>
<span><span class="co">##   K00010 . . | | . . . . . .</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="use-custom-biadjacency-matrices-with-anansiweb">Use custom biadjacency matrices with AnansiWeb()<a class="anchor" aria-label="anchor" href="#use-custom-biadjacency-matrices-with-anansiweb"></a>
</h3>
<p>The most flexible way to make an <code>AnansiWeb</code> object is
through <code><a href="../reference/AnansiWeb.html">AnansiWeb()</a></code>:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prep some dummy input tables</span></span>
<span>  <span class="va">tX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span>  <span class="va">tY</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Prep biadjacency matrix    </span></span>
<span><span class="co"># base::matrix is fine too, but will get coerced to Matrix::Matrix.</span></span>
<span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">35</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>    nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">NCOL</a></span><span class="op">(</span><span class="va">tY</span><span class="op">)</span>, </span>
<span>    ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">NCOL</a></span><span class="op">(</span><span class="va">tX</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span><span class="co"># make the AnansiWeb</span></span>
<span> <span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AnansiWeb.html">AnansiWeb</a></span><span class="op">(</span></span>
<span>    tableY <span class="op">=</span> <span class="va">tY</span>, </span>
<span>    tableX <span class="op">=</span> <span class="va">tX</span>,</span>
<span>    dictionary <span class="op">=</span> <span class="va">d</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in AnansiWeb(tableY = tY, tableX = tX, dictionary = d): Dimnames of</span></span>
<span><span class="co">## 'dictionary' were missing; Assigned 'y' and 'x'.</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Confirm the warning:  </span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "y" "x"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="additional-approaches">Additional approaches<a class="anchor" aria-label="anchor" href="#additional-approaches"></a>
</h3>
<p>There are numerous ways in which we can define an adjacency matrix.
Here, we demonstrate a graph-based and matrix based approach.</p>
<div class="section level4">
<h4 id="adjacency-matrices-with-igraph">adjacency matrices with <code>igraph</code><a class="anchor" aria-label="anchor" href="#adjacency-matrices-with-igraph"></a>
</h4>
<p>Importantly, (bi)adjacency matrices can be understood as graphs. Two
common packages that deal with graphs are <a href="https://r.igraph.org/" class="external-link"><code>igraph</code></a> and <a href="https://bioconductor.org/packages/graph/" class="external-link"><code>graph</code></a>.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/" class="external-link">igraph</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert data.frame to graph</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/graph_from_data_frame.html" class="external-link">graph_from_data_frame</a></span><span class="op">(</span><span class="va">krebs_edge_df</span>, directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Now that we have constructed a graph, we still need to identify which
features, vertices, belong to which data modality, in this case either
enzymes and metabolites. <code>igraph</code> does this using a boolean
vector, where <code>TRUE</code> values become columns, which corresponds
to <code>tableX</code>, whereas <code>FALSE</code> values become rows,
corresponding to <code>tableY</code>.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">krebs_edge_df</span><span class="op">$</span><span class="va">Enzyme</span></span>
<span></span>
<span><span class="co"># Now that we've defined type, we can convert to biadjacency matrix: </span></span>
<span><span class="va">bi_mat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/as_biadjacency_matrix.html" class="external-link">as_biadjacency_matrix</a></span><span class="op">(</span><span class="va">g</span>, sparse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">bi_mat1</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 4 x 5 sparse Matrix of class "dgTMatrix"</span></span>
<span><span class="co">##               aconitase citrate synthase fumarase succinate dehydrogenase</span></span>
<span><span class="co">## cis-aconitate         1                .        .                       .</span></span>
<span><span class="co">## citrate               1                1        .                       .</span></span>
<span><span class="co">## fumarate              .                .        1                       1</span></span>
<span><span class="co">## isocitrate            1                .        .                       .</span></span>
<span><span class="co">##               isocitrate dehydrogenase</span></span>
<span><span class="co">## cis-aconitate                        .</span></span>
<span><span class="co">## citrate                              .</span></span>
<span><span class="co">## fumarate                             .</span></span>
<span><span class="co">## isocitrate                           1</span></span></code></pre>
<p>Though biadjacency support in <code>graph</code> is currently
limited, We note that igraph and graph objects can be converted using
the <code><a href="https://r.igraph.org/reference/graph_from_graphnel.html" class="external-link">graph_from_graphnel()</a></code> and <code><a href="https://r.igraph.org/reference/as_graphnel.html" class="external-link">as_graphnel()</a></code>
functions in <code>igraph</code>.</p>
</div>
<div class="section level4">
<h4 id="adjacency-matrices-with-matrix">adjacency matrices with <code>Matrix</code><a class="anchor" aria-label="anchor" href="#adjacency-matrices-with-matrix"></a>
</h4>
<p>We can also define a matrix directly. Conveniently, sparse matrices
can be defined easily from our starting data. The <code>Matrix</code>
library provides fantastic support for this.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://Matrix.R-forge.R-project.org" class="external-link">Matrix</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># For this approach, it's useful to prepare the input as two factors:</span></span>
<span><span class="va">enzymes</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">krebs_edge_df</span><span class="op">$</span><span class="va">Enzyme</span><span class="op">)</span></span>
<span><span class="va">metabolites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">krebs_edge_df</span><span class="op">$</span><span class="va">Metabolite</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># We can get integers out of factors, corresponding to their level indices </span></span>
<span><span class="va">bi_mat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/sparseMatrix.html" class="external-link">sparseMatrix</a></span><span class="op">(</span>i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">enzymes</span><span class="op">)</span>, </span>
<span>             j <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">metabolites</span><span class="op">)</span>, </span>
<span>             dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>               <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Factor-class.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">enzymes</span><span class="op">)</span>,</span>
<span>               <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Factor-class.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">metabolites</span><span class="op">)</span></span>
<span>               <span class="op">)</span></span>
<span>             <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">bi_mat2</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 4 x 5 sparse Matrix of class "ngCMatrix"</span></span>
<span><span class="co">##                          cis-aconitate citrate fumarate isocitrate</span></span>
<span><span class="co">## aconitase                            |       |        .          |</span></span>
<span><span class="co">## citrate synthase                     .       |        .          .</span></span>
<span><span class="co">## fumarase                             .       .        |          .</span></span>
<span><span class="co">## isocitrate dehydrogenase             .       .        .          |</span></span>
<span><span class="co">##                          ketoglutarate</span></span>
<span><span class="co">## aconitase                            .</span></span>
<span><span class="co">## citrate synthase                     .</span></span>
<span><span class="co">## fumarase                             .</span></span>
<span><span class="co">## isocitrate dehydrogenase             |</span></span></code></pre>
</div>
</div>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.4.3 (2025-02-28)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">## Running under: Ubuntu 24.04.2 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] Matrix_1.7-2     igraph_2.1.4     patchwork_1.3.0  ggplot2_3.5.1   </span></span>
<span><span class="co">## [5] anansi_0.6.0     BiocStyle_2.34.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] SummarizedExperiment_1.36.0 gtable_0.3.6               </span></span>
<span><span class="co">##  [3] xfun_0.51                   bslib_0.9.0                </span></span>
<span><span class="co">##  [5] htmlwidgets_1.6.4           Biobase_2.66.0             </span></span>
<span><span class="co">##  [7] lattice_0.22-6              vctrs_0.6.5                </span></span>
<span><span class="co">##  [9] tools_4.4.3                 generics_0.1.3             </span></span>
<span><span class="co">## [11] stats4_4.4.3                parallel_4.4.3             </span></span>
<span><span class="co">## [13] tibble_3.2.1                pkgconfig_2.0.3            </span></span>
<span><span class="co">## [15] desc_1.4.3                  S4Vectors_0.44.0           </span></span>
<span><span class="co">## [17] lifecycle_1.0.4             GenomeInfoDbData_1.2.13    </span></span>
<span><span class="co">## [19] farver_2.1.2                compiler_4.4.3             </span></span>
<span><span class="co">## [21] textshaping_1.0.0           munsell_0.5.1              </span></span>
<span><span class="co">## [23] ggforce_0.4.2               codetools_0.2-20           </span></span>
<span><span class="co">## [25] GenomeInfoDb_1.42.3         htmltools_0.5.8.1          </span></span>
<span><span class="co">## [27] sass_0.4.9                  yaml_2.3.10                </span></span>
<span><span class="co">## [29] tidyr_1.3.1                 pkgdown_2.1.1              </span></span>
<span><span class="co">## [31] pillar_1.10.1               crayon_1.5.3               </span></span>
<span><span class="co">## [33] jquerylib_0.1.4             MASS_7.3-64                </span></span>
<span><span class="co">## [35] DelayedArray_0.32.0         cachem_1.1.0               </span></span>
<span><span class="co">## [37] abind_1.4-8                 parallelly_1.42.0          </span></span>
<span><span class="co">## [39] tidyselect_1.2.1            digest_0.6.37              </span></span>
<span><span class="co">## [41] future_1.34.0               purrr_1.0.4                </span></span>
<span><span class="co">## [43] dplyr_1.1.4                 bookdown_0.42              </span></span>
<span><span class="co">## [45] listenv_0.9.1               labeling_0.4.3             </span></span>
<span><span class="co">## [47] polyclip_1.10-7             fastmap_1.2.0              </span></span>
<span><span class="co">## [49] grid_4.4.3                  colorspace_2.1-1           </span></span>
<span><span class="co">## [51] cli_3.6.4                   SparseArray_1.6.2          </span></span>
<span><span class="co">## [53] magrittr_2.0.3              S4Arrays_1.6.0             </span></span>
<span><span class="co">## [55] future.apply_1.11.3         withr_3.0.2                </span></span>
<span><span class="co">## [57] scales_1.3.0                UCSC.utils_1.2.0           </span></span>
<span><span class="co">## [59] rmarkdown_2.29              XVector_0.46.0             </span></span>
<span><span class="co">## [61] httr_1.4.7                  matrixStats_1.5.0          </span></span>
<span><span class="co">## [63] globals_0.16.3              ragg_1.3.3                 </span></span>
<span><span class="co">## [65] evaluate_1.0.3              knitr_1.49                 </span></span>
<span><span class="co">## [67] GenomicRanges_1.58.0        IRanges_2.40.1             </span></span>
<span><span class="co">## [69] MultiAssayExperiment_1.32.0 rlang_1.1.5                </span></span>
<span><span class="co">## [71] Rcpp_1.0.14                 glue_1.8.0                 </span></span>
<span><span class="co">## [73] tweenr_2.0.3                BiocManager_1.30.25        </span></span>
<span><span class="co">## [75] BiocGenerics_0.52.0         jsonlite_1.9.1             </span></span>
<span><span class="co">## [77] R6_2.6.1                    MatrixGenerics_1.18.1      </span></span>
<span><span class="co">## [79] systemfonts_1.2.1           fs_1.6.5                   </span></span>
<span><span class="co">## [81] zlibbioc_1.52.0</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomaz Bastiaanssen, Thomas Quinn, Giulio Benedetti, Leo Lahti.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
